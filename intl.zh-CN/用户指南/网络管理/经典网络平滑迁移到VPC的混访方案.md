# 经典网络平滑迁移到VPC的混访方案 {#concept_ytc_d1y_wdb .concept}

[专有网络VPC](https://www.alibabacloud.com/help/doc-detail/34217.htm)（Virtual Private Cloud）之间在逻辑上彻底隔离，可以使您在阿里云上构建出一个隔离的网络环境，其安全性及性能都高于经典网络，已成为云上用户首选的网络类型。为满足日益增多的网络迁移需求，RDS新增了网络混访功能，可实现在无闪断、无访问中断的情况下将经典网络平滑迁移到VPC上，且主实例和各只读实例可以分别使用混访方案迁移网络，互不影响。本文将介绍通过RDS管理控制台采用混访方案将经典网络迁移到VPC的操作步骤。

## 背景信息 {#section_lqq_w1y_wdb .section}

以往将RDS实例从经典网络迁移到VPC时，经典网络的内网地址会被立即释放，会造成1次30秒内的闪断且在经典网络中的ECS将不能再通过内网访问该RDS实例，这会对业务产生一定的影响。特别是对于许多大公司而言，一台数据库会被多个应用系统访问，而当他们决定从经典网络切换到VPC时，很难做到同时切换，对业务产生的影响更大，需要有一个过渡期。于是，为能满足平滑迁移网络的需求，RDS新增了混访功能，就提供了这样一个过渡期。

混访是指RDS实例可以同时被经典网络和专有网络中的ECS访问。在混访期间，RDS实例会保留原经典网络的内网地址并新增一个VPC下的内网地址，迁移网络时不会出现闪断。基于安全性及性能的考虑，我们推荐您仅使用VPC，因此混访期有一定的期限，原经典网络的内网地址在保留时间到期后会被自动释放，应用将无法通过经典网络的内网地址访问数据库。为避免对业务造成影响，您需要在混访期中将VPC下的内网地址配置到您所有的应用中，以实现平滑的网络迁移。

例如，某一公司要将经典网络迁移至VPC时，若选用混访的迁移方式，在混访期内，一部分应用通过VPC访问数据库，一部分应用仍通过原经典网络的内网地址访问数据库，等所有应用都可以通过VPC访问数据库时，就可以将原经典网络的内网地址释放掉，如下图所示。

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/7944/4743_zh-CN.png)

## 功能限制 {#section_tzs_y1y_wdb .section}

在混访期间，有如下功能限制：

-   不支持切换成经典网络。

-   不支持迁移可用区。

-   不支持高可用版及金融版之间的相互切换。


## 前提条件 {#section_rzd_nx2_zdb .section}

-   实例的网络类型是经典网络。

-   实例所在可用区已有可用的VPC和交换机。关于创建VPC的步骤，请参见[创建VPC](https://www.alibabacloud.com/help/doc-detail/53604.htm)。关于创建交换机的步骤，请参见[创建交换机](https://www.alibabacloud.com/help/doc-detail/53670.htm)。


## 从经典网络平滑迁移至VPC {#section_cy4_px2_zdb .section}

1.  登录[RDS 管理控制台](https://rds.console.aliyun.com/)。
2.  选择目标实例所在地域。
3.  单击目标实例的ID，进入基本信息页面。
4.  在左侧导航栏中选择**数据库连接**，进入数据库连接页面。
5.  在实例连接标签页中，单击**切换为专有网络**。
6.  在切换为专有网络确认页面，选择要切换到的VPC及虚拟交换机。
7.  勾选**保留原经典网络**，并选择原经典网络内网地址的**过期时间**，如下图所示。

    **说明：** 

    -   从要删除原经典网络地址前的第7天开始，系统会每天给您账号绑定的手机发送提示短信。

    -   原经典网络内网地址的保留时间到期后，内网地址会被自动释放，您将无法通过经典网络的内网地址访问数据库。为避免业务中断，请根据实际需求设置保留时间。混访设置成功后，您可以修改过期时间。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/7944/4745_zh-CN.png)

8.  单击**确定**，控制台会增加**保留的经典网络地址**，详情如下图所示。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/7944/4747_zh-CN.png)


## 修改原经典网络内网地址的过期时间 {#section_pwp_wx2_zdb .section}

在混访期间，您可以根据需求随时调整保留原经典网络的时间，过期时间会从变更日期重新开始计时。例如，原经典网络的内网地址会在2017年8月18日过期，但您在2017年8月15日将过期时间变更为“14天后”，则原经典网络的内网地址将会在2017年8月29日被释放。

修改过期时间的操作步骤如下所示：

1.  登录[RDS 管理控制台](https://rds.console.aliyun.com/)。
2.  选择目标实例所在地域。
3.  单击目标实例的ID，进入基本信息页面。
4.  在左侧导航栏中选择**数据库连接**，进入数据库连接页面。
5.  在实例连接标签页中，单击**修改过期时间**，如下图所示。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/7944/4748_zh-CN.png)

6.  在修改过期时间的确认页面，选择过期时间，单击**确定**。

